import json
import random

input_path = "converted.jsonl"
output_path = "converted_with_prompt.jsonl"

prompt_templates = [
    "{}로 시작하는 스토리",
    "{}라는 내용의 이야기",
    "{}에 관한 창의적인 글쓰기",
    "상상력을 발휘하여 {}을 기반으로 한 이야기",
    "{}을 주제로 한 짧은 동화",
    "{}으로 시작되는 감동적인 이야기",
    "{}을 중심으로 한 흥미진진한 이야기",
    "{}에서 벌어지는 모험 이야기",
    "{}의 이야기를 들려주는 글",
    "{}을 소재로 한 환상적인 이야기",
    "마법 같은 {} 이야기",
    "{}을 주제로 한 짧은 글",
    "{}을 소재로 한 교훈적인 이야기",
    "{}에서 일어난 사건을 다룬 이야기",
    "{}으로 시작되는 재미있는 스토리",
    "{}를 주제로 한 상상력 가득한 글",
    "{}의 모험을 그린 이야기",
    "창의력을 발휘한 {} 이야기",
    "{}로 시작되는 신비로운 이야기",
    "{}를 주제로 한 감성적인 이야기",
    "{}의 사건을 그린 짧은 이야기",
    "{}로 이루어진 상상 속 이야기",
    "{}에서 시작되는 모험",
    "{}을 배경으로 한 짧은 동화",
    "{}의 세계를 담은 이야기",
    "{}에서 벌어진 신기한 사건",
    "{}을 주제로 한 창작 이야기",
    "{}을 소재로 한 이야기",
    "{}의 모험과 성장을 그린 이야기",
    "{}로 시작되는 모험담",
    "{}을 배경으로 한 환상 이야기",
    "{}에서 펼쳐지는 상상력 이야기",
    "{}를 주제로 한 재미있는 스토리",
    "{}의 이야기를 상상하여 쓰기",
    "{}을 소재로 한 감동적인 이야기",
    "{}에서 벌어진 모험 이야기",
    "{}의 세계를 상상하며 만든 이야기",
    "{}를 주제로 한 창의적인 글",
    "{}의 사건을 바탕으로 한 스토리",
    "{}으로 시작되는 흥미로운 이야기",
    "{}을 배경으로 한 재미있는 동화",
    "{}의 이야기를 상상하여 작성",
    "{}을 주제로 한 짧고 재미있는 이야기",
    "{}에서 벌어진 흥미진진한 사건",
    "{}을 소재로 한 창의적인 스토리",
    "{}의 세계에서 일어난 이야기",
    "{}으로 시작되는 교훈적인 이야기",
    "{}를 주제로 한 상상력 스토리",
    "{}의 모험과 우정을 그린 이야기",
    "{}에서 일어난 신비한 사건 이야기",
    "{}을 주제로 한 따뜻한 이야기",
    "{}의 사건을 담은 글쓰기",
    "{}으로 시작되는 감동적인 이야기",
    "{}의 세계를 탐험하는 이야기",
    "{}을 소재로 한 모험 이야기",
    "{}의 이야기를 재미있게 풀어낸 글",
    "{}에서 일어난 창의적인 사건",
    "{}를 주제로 한 환상적인 동화",
    "{}로 시작되는 재미있고 창의적인 이야기",
    "{}의 모험과 사건을 그린 이야기",
    "{}에서 벌어진 놀라운 사건",
    "{}의 이야기를 바탕으로 한 창작 글",
    "{}을 주제로 한 상상력 가득한 동화",
    "{}으로 시작되는 짧은 이야기",
    "{}의 사건과 모험을 담은 글",
    "{}의 세계를 상상하며 쓴 스토리",
    "{}에서 벌어진 신비로운 사건",
    "{}을 주제로 한 재미있고 창의적인 이야기",
    "{}의 모험과 감정을 담은 이야기",
    "{}로 시작되는 상상 속 스토리",
    "{}에서 일어난 흥미진진한 사건",
    "{}의 이야기를 창의적으로 쓴 글"
]


with open(input_path, "r", encoding="utf-8") as fin, open(output_path, "w", encoding="utf-8") as fout:
    for line in fin:
        obj = json.loads(line)
        text = obj["text"]

        # <start> 다음 첫 문장 추출
        start_len = len("<start>")
        remaining_text = text[start_len:].strip()
        first_period = remaining_text.find(".")
        if first_period == -1:
            first_period = len(remaining_text)
        first_sentence = remaining_text[:first_period+1].strip()

        # 랜덤 템플릿 선택
        template = random.choice(prompt_templates)
        prompt = template.format(first_sentence)

        new_obj = {
            "prompt": prompt,
            "text": text,
            "score": obj.get("score", 0)
        }
        fout.write(json.dumps(new_obj, ensure_ascii=False) + "\n")
